<!DOCTYPE html>
<html lang='ja'>
<head>
  <meta charset="utf-8">
  <title>ボタン探し</title>
  <style>
    .transparent-button {
      background: none;
      border: none;
      color: inherit;
      cursor: pointer;
      padding: 10px 20px;
      font-size: 16px;
      text-align: center;
      width: 100px;
      height: 50px;
      position: absolute;
      opacity: 0; /* ボタンを透明に */
    }
    .reset-button, .start-button, .reset-highscore-button, .rules-button {
      position: fixed;
      left: 10px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      border: none;
      color: white;
    }
    .reset-button {
      top: 70px;
      background-color: red;
    }
    .reset-highscore-button {
      top: 10px;
      background-color: blue;
    }
    .rules-button {
      top: 130px;  /* ルール説明ボタンの位置（スタートボタンの上） */
      background-color: orange;
    }
    .start-button {
      top: 190px;  /* スタートボタンの位置を調整 */
      background-color: green;
    }
    body, html {
      margin: 0;
      height: 100%;
      overflow: hidden;
      background-color: black;
      color: white;
    }
    .position-container {
      position: relative;
      width: 100%;
      height: 100%;
    }
    #score, #timer, #highScore {
      position: fixed;
      font-size: 24px;
      color: white;
    }
    #score {
      top: 40px;
      right: 10px;
    }
    #timer {
      top: 70px;
      right: 10px;
    }
    #highScore {
      top: 10px;
      right: 10px;
    }
  </style>
</head>
<body>
  <div class="position-container">
    <button class="transparent-button" id="button" tabindex="-1"></button>
  </div>
  <div id="highScore">最高スコア: 0</div>
  <div id="score">ポイント: 0</div>
  <div id="timer">残り時間: 60秒</div>
  <button class="reset-button" id="resetButton">リセット</button>
  <button class="reset-highscore-button" id="resetHighScoreButton">最高スコアリセット</button>
  <button class="rules-button" id="rulesButton">ルール説明</button>
  <button class="start-button" id="startButton">ゲームスタート</button>

  <script>
    let points = 0, timer = 60, gameStarted = false, countdownInterval;

    const updateHighScore = () => {
      const highestScore = localStorage.getItem('highestScore') || 0;
      document.getElementById('highScore').textContent = `最高スコア: ${highestScore}`;
    };

    const updateScore = () => {
      document.getElementById('score').textContent = `ポイント: ${points}`;
    };

    const updateTimer = () => {
      document.getElementById('timer').textContent = `残り時間: ${timer}秒`;
    };

    const startTimer = () => {
      countdownInterval = setInterval(() => {
        timer--;
        updateTimer();
        if (timer <= 0) {
          clearInterval(countdownInterval);
          alert("時間終了！ あなたのポイント: " + points);
          saveScore(); 
        }
      }, 1000);
    };

    const moveButton = () => {
      const button = document.getElementById('button');
      const container = document.querySelector('.position-container');
      button.style.left = `${Math.random() * (container.offsetWidth - button.offsetWidth)}px`;
      button.style.top = `${Math.random() * (container.offsetHeight - button.offsetHeight)}px`;
    };

    document.getElementById('button').addEventListener('click', () => {
      if (gameStarted) {
        points++; updateScore(); moveButton();
        alert("よく気づいたね！");
      }
    });

    document.getElementById('resetButton').addEventListener('click', () => {
      points = 0; timer = 60;
      updateScore(); updateTimer();
      clearInterval(countdownInterval);
      gameStarted = false;
      alert("ゲームがリセットされました");
    });

    document.getElementById('resetHighScoreButton').addEventListener('click', () => {
      localStorage.removeItem('highestScore');
      updateHighScore();
      alert("最高スコアがリセットされました");
    });

    const saveScore = () => {
      const highestScore = localStorage.getItem('highestScore') || 0;
      if (points > highestScore) {
        localStorage.setItem('highestScore', points);
        alert("新記録！ あなたの最高スコアは: " + points);
      }
      updateHighScore();
    };

    document.getElementById('startButton').addEventListener('click', () => {
      if (!gameStarted) {
        gameStarted = true;
        startTimer(); moveButton(); updateScore(); updateTimer();
        alert("ゲームがスタートしました！");
      } else {
        alert("すでにゲームが始まっています");
      }
    });

    document.getElementById('rulesButton').addEventListener('click', () => {
      alert("ルール: 制限時間内に隠れたボタンをクリックして、できるだけ多くのポイントを獲得しましょう！");
    });

    // Enterキーが押されたときのデフォルト動作を無効にする
    document.addEventListener('keydown', (event) => {
      if (event.key === 'Enter') {
        event.preventDefault();
      }
    });

    window.onload = () => {
      updateScore();
      updateTimer();
      updateHighScore();
    };
  </script>
</body>
</html>
